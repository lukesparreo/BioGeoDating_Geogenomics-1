labs(title = label, x = "Divergence Time (Years)", y = "Density") +
theme_minimal() +
theme(legend.position = "none",
plot.title = element_text(size = 10, hjust = 0.5))
}
# Create the plots for each tree
plots <- lapply(tree_paths, function(file) {
# Extract the label from the file path (for use in plot title)
label <- basename(file) # Using the file name as the label
make_divergence_density_plot(file, label)
})
# Arrange the plots into a grid
grid.arrange(grobs = plots, ncol = 2)
#NODE POSTERIORS FOR ALL TREES
library(RevGadgets)
library(ggplot2)
library(dplyr)
library(tidyr)
library(gridExtra)
library(viridis)
# Define base path
base_path <- "/../../../BioGeoDating_Geogenomics"
# Define tree paths
tree_paths <- c(
"migration0/results/informed_uniform_migration0_combined/informed_uniform_migration0_combined.mcc.tre",
"migration0/results/informed_normal_migration0_combined/informed_normal_migration0_combined.mcc.tre",
"migration0/results/geo_unknown_migration0_combined/geo_unknown_migration0_combined.mcc.tre",
"migration0/results/incorrect_uniform_migration0_combined/incorrect_uniform_migration0_combined.mcc.tre",
"migration0/results/incorrect_normal_migration0_combined/incorrect_normal_migration0_combined.mcc.tre",
"migration0.2/results/informed_uniform_geneflow_combined/informed_uniform_geneflow_combined.mcc.tre",
"migration0.2/results/informed_normal_geneflow_combined/informed_normal_geneflow_combined.mcc.tre",
"migration0.2/results/geo_unknown_geneflow_combined/geo_unknown_geneflow_combined.mcc.tre",
"migration0.2/results/incorrect_uniform_geneflow_combined/incorrect_uniform_geneflow_combined.mcc.tre",
"migration0.2/results/incorrect_normal_geneflow_combined/incorrect_normal_geneflow_combined.mcc.tre"
)
# Descriptive plot titles
plot_titles <- c(
"Informed Uniform (no migration)",
"Informed Normal (no migration)",
"Geo Unknown (no migration)",
"Incorrect Uniform (no migration)",
"Incorrect Normal (no migration)",
"Informed Uniform (with gene flow)",
"Informed Normal (with gene flow)",
"Geo Unknown (with gene flow)",
"Incorrect Uniform (with gene flow)",
"Incorrect Normal (with gene flow)"
)
# Empty list to store plots
all_plots <- list()
# Loop through files and make plots
for (i in seq_along(tree_paths)) {
full_path <- file.path(base_path, tree_paths[i])
tree <- readTrees(paths = full_path)
tree_data <- tree[[1]][[1]]
annotations <- tree_data@data
expanded <- annotations %>%
filter(!is.na(age_0.95_HPD)) %>%
rowwise() %>%
mutate(posterior_values = list(seq(age_0.95_HPD[1], age_0.95_HPD[2], length.out = 100))) %>%
unnest(posterior_values)
p <- ggplot(expanded, aes(x = posterior_values, fill = as.factor(node))) +
geom_density(alpha = 0.5, adjust = 1.5) +
labs(title = plot_titles[i], x = NULL, y = NULL) +
theme_minimal() +
theme(legend.position = "none", plot.title = element_text(size = 10, hjust = 0.5)) +
scale_fill_viridis_d() +
scale_x_reverse(limits = c(5, -1), breaks = 0:5)
all_plots[[i]] <- p
}
# Reordered plot list
ordered_plots <- c(
all_plots[1], all_plots[6], all_plots[2], all_plots[7], all_plots[3], # Row 1 (no migration)
all_plots[8], all_plots[4], all_plots[9], all_plots[5], all_plots[10]  # Row 2 (with gene flow)
)
# Arrange all plots in a grid (2 columns x 5 rows)
grid.arrange(grobs = ordered_plots, ncol = 1)
# Define base path
base_path <- "/../../../BioGeoDating_Geogenomics"
# Define tree paths
tree_paths <- c(
"migration0/results/informed_uniform_migration0_combined/informed_uniform_migration0_combined.mcc.tre",
"migration0/results/informed_normal_migration0_combined/informed_normal_migration0_combined.mcc.tre",
"migration0/results/geo_unknown_migration0_combined/geo_unknown_migration0_combined.mcc.tre",
"migration0/results/incorrect_uniform_migration0_combined/incorrect_uniform_migration0_combined.mcc.tre",
"migration0/results/incorrect_normal_migration0_combined/incorrect_normal_migration0_combined.mcc.tre",
"migration0.2/results/informed_uniform_geneflow_combined/informed_uniform_geneflow_combined.mcc.tre",
"migration0.2/results/informed_normal_geneflow_combined/informed_normal_geneflow_combined.mcc.tre",
"migration0.2/results/geo_unknown_geneflow_combined/geo_unknown_geneflow_combined.mcc.tre",
"migration0.2/results/incorrect_uniform_geneflow_combined/incorrect_uniform_geneflow_combined.mcc.tre",
"migration0.2/results/incorrect_normal_geneflow_combined/incorrect_normal_geneflow_combined.mcc.tre"
)
# Descriptive plot titles
plot_titles <- c(
"Informed Uniform (no migration)",
"Informed Normal (no migration)",
"Geo Unknown (no migration)",
"Incorrect Uniform (no migration)",
"Incorrect Normal (no migration)",
"Informed Uniform (with gene flow)",
"Informed Normal (with gene flow)",
"Geo Unknown (with gene flow)",
"Incorrect Uniform (with gene flow)",
"Incorrect Normal (with gene flow)"
)
# Empty list to store plots
all_plots <- list()
# Loop through files and make plots
for (i in seq_along(tree_paths)) {
full_path <- file.path(base_path, tree_paths[i])
tree <- readTrees(paths = full_path)
tree_data <- tree[[1]][[1]]
annotations <- tree_data@data
expanded <- annotations %>%
filter(!is.na(age_0.95_HPD)) %>%
rowwise() %>%
mutate(posterior_values = list(seq(age_0.95_HPD[1], age_0.95_HPD[2], length.out = 100))) %>%
unnest(posterior_values)
p <- ggplot(expanded, aes(x = posterior_values, fill = as.factor(node))) +
geom_density(alpha = 0.5, adjust = 1.5) +
labs(title = plot_titles[i], x = NULL, y = NULL) +
theme_minimal() +
theme(legend.position = "none", plot.title = element_text(size = 10, hjust = 0.5)) +
scale_fill_viridis_d() +
scale_x_reverse(limits = c(5, -1), breaks = 0:5)
all_plots[[i]] <- p
}
# Define base path
base_path <- "/../../../BioGeoDating_Geogenomics/"
# Define tree paths
tree_paths <- c(
"migration0/results/informed_uniform_migration0_combined/informed_uniform_migration0_combined.mcc.tre",
"migration0/results/informed_normal_migration0_combined/informed_normal_migration0_combined.mcc.tre",
"migration0/results/geo_unknown_migration0_combined/geo_unknown_migration0_combined.mcc.tre",
"migration0/results/incorrect_uniform_migration0_combined/incorrect_uniform_migration0_combined.mcc.tre",
"migration0/results/incorrect_normal_migration0_combined/incorrect_normal_migration0_combined.mcc.tre",
"migration0.2/results/informed_uniform_geneflow_combined/informed_uniform_geneflow_combined.mcc.tre",
"migration0.2/results/informed_normal_geneflow_combined/informed_normal_geneflow_combined.mcc.tre",
"migration0.2/results/geo_unknown_geneflow_combined/geo_unknown_geneflow_combined.mcc.tre",
"migration0.2/results/incorrect_uniform_geneflow_combined/incorrect_uniform_geneflow_combined.mcc.tre",
"migration0.2/results/incorrect_normal_geneflow_combined/incorrect_normal_geneflow_combined.mcc.tre"
)
# Descriptive plot titles
plot_titles <- c(
"Informed Uniform (no migration)",
"Informed Normal (no migration)",
"Geo Unknown (no migration)",
"Incorrect Uniform (no migration)",
"Incorrect Normal (no migration)",
"Informed Uniform (with gene flow)",
"Informed Normal (with gene flow)",
"Geo Unknown (with gene flow)",
"Incorrect Uniform (with gene flow)",
"Incorrect Normal (with gene flow)"
)
# Empty list to store plots
all_plots <- list()
# Loop through files and make plots
for (i in seq_along(tree_paths)) {
full_path <- file.path(base_path, tree_paths[i])
tree <- readTrees(paths = full_path)
tree_data <- tree[[1]][[1]]
annotations <- tree_data@data
expanded <- annotations %>%
filter(!is.na(age_0.95_HPD)) %>%
rowwise() %>%
mutate(posterior_values = list(seq(age_0.95_HPD[1], age_0.95_HPD[2], length.out = 100))) %>%
unnest(posterior_values)
p <- ggplot(expanded, aes(x = posterior_values, fill = as.factor(node))) +
geom_density(alpha = 0.5, adjust = 1.5) +
labs(title = plot_titles[i], x = NULL, y = NULL) +
theme_minimal() +
theme(legend.position = "none", plot.title = element_text(size = 10, hjust = 0.5)) +
scale_fill_viridis_d() +
scale_x_reverse(limits = c(5, -1), breaks = 0:5)
all_plots[[i]] <- p
}
# Define base path
basepath <- "/../../BioGeoDating_Geogenomics"
# Define tree paths
tree_paths <- c(
"migration0/results/informed_uniform_migration0_combined/informed_uniform_migration0_combined.mcc.tre",
"migration0/results/informed_normal_migration0_combined/informed_normal_migration0_combined.mcc.tre",
"migration0/results/geo_unknown_migration0_combined/geo_unknown_migration0_combined.mcc.tre",
"migration0/results/incorrect_uniform_migration0_combined/incorrect_uniform_migration0_combined.mcc.tre",
"migration0/results/incorrect_normal_migration0_combined/incorrect_normal_migration0_combined.mcc.tre",
"migration0.2/results/informed_uniform_geneflow_combined/informed_uniform_geneflow_combined.mcc.tre",
"migration0.2/results/informed_normal_geneflow_combined/informed_normal_geneflow_combined.mcc.tre",
"migration0.2/results/geo_unknown_geneflow_combined/geo_unknown_geneflow_combined.mcc.tre",
"migration0.2/results/incorrect_uniform_geneflow_combined/incorrect_uniform_geneflow_combined.mcc.tre",
"migration0.2/results/incorrect_normal_geneflow_combined/incorrect_normal_geneflow_combined.mcc.tre"
)
# Descriptive plot titles
plot_titles <- c(
"Informed Uniform (no migration)",
"Informed Normal (no migration)",
"Geo Unknown (no migration)",
"Incorrect Uniform (no migration)",
"Incorrect Normal (no migration)",
"Informed Uniform (with gene flow)",
"Informed Normal (with gene flow)",
"Geo Unknown (with gene flow)",
"Incorrect Uniform (with gene flow)",
"Incorrect Normal (with gene flow)"
)
# Empty list to store plots
all_plots <- list()
# Loop through files and make plots
for (i in seq_along(tree_paths)) {
full_path <- file.path(base_path, tree_paths[i])
tree <- readTrees(paths = full_path)
tree_data <- tree[[1]][[1]]
annotations <- tree_data@data
expanded <- annotations %>%
filter(!is.na(age_0.95_HPD)) %>%
rowwise() %>%
mutate(posterior_values = list(seq(age_0.95_HPD[1], age_0.95_HPD[2], length.out = 100))) %>%
unnest(posterior_values)
p <- ggplot(expanded, aes(x = posterior_values, fill = as.factor(node))) +
geom_density(alpha = 0.5, adjust = 1.5) +
labs(title = plot_titles[i], x = NULL, y = NULL) +
theme_minimal() +
theme(legend.position = "none", plot.title = element_text(size = 10, hjust = 0.5)) +
scale_fill_viridis_d() +
scale_x_reverse(limits = c(5, -1), breaks = 0:5)
all_plots[[i]] <- p
}
# Define base path
basepath <- "../BioGeoDating_Geogenomics"
# Define tree paths
tree_paths <- c(
"migration0/results/informed_uniform_migration0_combined/informed_uniform_migration0_combined.mcc.tre",
"migration0/results/informed_normal_migration0_combined/informed_normal_migration0_combined.mcc.tre",
"migration0/results/geo_unknown_migration0_combined/geo_unknown_migration0_combined.mcc.tre",
"migration0/results/incorrect_uniform_migration0_combined/incorrect_uniform_migration0_combined.mcc.tre",
"migration0/results/incorrect_normal_migration0_combined/incorrect_normal_migration0_combined.mcc.tre",
"migration0.2/results/informed_uniform_geneflow_combined/informed_uniform_geneflow_combined.mcc.tre",
"migration0.2/results/informed_normal_geneflow_combined/informed_normal_geneflow_combined.mcc.tre",
"migration0.2/results/geo_unknown_geneflow_combined/geo_unknown_geneflow_combined.mcc.tre",
"migration0.2/results/incorrect_uniform_geneflow_combined/incorrect_uniform_geneflow_combined.mcc.tre",
"migration0.2/results/incorrect_normal_geneflow_combined/incorrect_normal_geneflow_combined.mcc.tre"
)
# Descriptive plot titles
plot_titles <- c(
"Informed Uniform (no migration)",
"Informed Normal (no migration)",
"Geo Unknown (no migration)",
"Incorrect Uniform (no migration)",
"Incorrect Normal (no migration)",
"Informed Uniform (with gene flow)",
"Informed Normal (with gene flow)",
"Geo Unknown (with gene flow)",
"Incorrect Uniform (with gene flow)",
"Incorrect Normal (with gene flow)"
)
# Empty list to store plots
all_plots <- list()
# Loop through files and make plots
for (i in seq_along(tree_paths)) {
full_path <- file.path(base_path, tree_paths[i])
tree <- readTrees(paths = full_path)
tree_data <- tree[[1]][[1]]
annotations <- tree_data@data
expanded <- annotations %>%
filter(!is.na(age_0.95_HPD)) %>%
rowwise() %>%
mutate(posterior_values = list(seq(age_0.95_HPD[1], age_0.95_HPD[2], length.out = 100))) %>%
unnest(posterior_values)
p <- ggplot(expanded, aes(x = posterior_values, fill = as.factor(node))) +
geom_density(alpha = 0.5, adjust = 1.5) +
labs(title = plot_titles[i], x = NULL, y = NULL) +
theme_minimal() +
theme(legend.position = "none", plot.title = element_text(size = 10, hjust = 0.5)) +
scale_fill_viridis_d() +
scale_x_reverse(limits = c(5, -1), breaks = 0:5)
all_plots[[i]] <- p
}
# Reordered plot list
ordered_plots <- c(
all_plots[1], all_plots[6], all_plots[2], all_plots[7], all_plots[3], # Row 1 (no migration)
all_plots[8], all_plots[4], all_plots[9], all_plots[5], all_plots[10]  # Row 2 (with gene flow)
)
# Arrange all plots in a grid (2 columns x 5 rows)
grid.arrange(grobs = ordered_plots, ncol = 1)
# Define base path
basepath <- "../BioGeoDating_Geogenomics"
# Define tree paths
tree_paths <- c(
"migration0/results/informed_uniform_migration0_combined/informed_uniform_migration0_combined.mcc.tre",
"migration0/results/informed_normal_migration0_combined/informed_normal_migration0_combined.mcc.tre",
"migration0/results/geo_unknown_migration0_combined/geo_unknown_migration0_combined.mcc.tre",
"migration0/results/incorrect_uniform_migration0_combined/incorrect_uniform_migration0_combined.mcc.tre",
"migration0/results/incorrect_normal_migration0_combined/incorrect_normal_migration0_combined.mcc.tre",
"migration0.2/results/informed_uniform_geneflow_combined/informed_uniform_geneflow_combined.mcc.tre",
"migration0.2/results/informed_normal_geneflow_combined/informed_normal_geneflow_combined.mcc.tre",
"migration0.2/results/geo_unknown_geneflow_combined/geo_unknown_geneflow_combined.mcc.tre",
"migration0.2/results/incorrect_uniform_geneflow_combined/incorrect_uniform_geneflow_combined.mcc.tre",
"migration0.2/results/incorrect_normal_geneflow_combined/incorrect_normal_geneflow_combined.mcc.tre"
)
setwd("~/Desktop/BioGeoDating_Geogenomics")
# Define tree paths
tree_paths <- c(
"migration0/results/informed_uniform_migration0_combined/informed_uniform_migration0_combined.mcc.tre",
"migration0/results/informed_normal_migration0_combined/informed_normal_migration0_combined.mcc.tre",
"migration0/results/geo_unknown_migration0_combined/geo_unknown_migration0_combined.mcc.tre",
"migration0/results/incorrect_uniform_migration0_combined/incorrect_uniform_migration0_combined.mcc.tre",
"migration0/results/incorrect_normal_migration0_combined/incorrect_normal_migration0_combined.mcc.tre",
"migration0.2/results/informed_uniform_geneflow_combined/informed_uniform_geneflow_combined.mcc.tre",
"migration0.2/results/informed_normal_geneflow_combined/informed_normal_geneflow_combined.mcc.tre",
"migration0.2/results/geo_unknown_geneflow_combined/geo_unknown_geneflow_combined.mcc.tre",
"migration0.2/results/incorrect_uniform_geneflow_combined/incorrect_uniform_geneflow_combined.mcc.tre",
"migration0.2/results/incorrect_normal_geneflow_combined/incorrect_normal_geneflow_combined.mcc.tre"
)
# Descriptive plot titles
plot_titles <- c(
"Informed Uniform (no migration)",
"Informed Normal (no migration)",
"Geo Unknown (no migration)",
"Incorrect Uniform (no migration)",
"Incorrect Normal (no migration)",
"Informed Uniform (with gene flow)",
"Informed Normal (with gene flow)",
"Geo Unknown (with gene flow)",
"Incorrect Uniform (with gene flow)",
"Incorrect Normal (with gene flow)"
)
# Empty list to store plots
all_plots <- list()
# Loop through files and make plots
for (i in seq_along(tree_paths)) {
full_path <- file.path(base_path, tree_paths[i])
tree <- readTrees(paths = full_path)
tree_data <- tree[[1]][[1]]
annotations <- tree_data@data
expanded <- annotations %>%
filter(!is.na(age_0.95_HPD)) %>%
rowwise() %>%
mutate(posterior_values = list(seq(age_0.95_HPD[1], age_0.95_HPD[2], length.out = 100))) %>%
unnest(posterior_values)
p <- ggplot(expanded, aes(x = posterior_values, fill = as.factor(node))) +
geom_density(alpha = 0.5, adjust = 1.5) +
labs(title = plot_titles[i], x = NULL, y = NULL) +
theme_minimal() +
theme(legend.position = "none", plot.title = element_text(size = 10, hjust = 0.5)) +
scale_fill_viridis_d() +
scale_x_reverse(limits = c(5, -1), breaks = 0:5)
all_plots[[i]] <- p
}
# Reordered plot list
ordered_plots <- c(
all_plots[1], all_plots[6], all_plots[2], all_plots[7], all_plots[3], # Row 1 (no migration)
all_plots[8], all_plots[4], all_plots[9], all_plots[5], all_plots[10]  # Row 2 (with gene flow)
)
# Arrange all plots in a grid (2 columns x 5 rows)
grid.arrange(grobs = ordered_plots, ncol = 1)
# Define base path
base_path <- "/Users/lukesparreo/Desktop/BioGeoDating_Geogenomics"
# Define tree paths
tree_paths <- c(
"migration0/results/informed_uniform_migration0_combined/informed_uniform_migration0_combined.mcc.tre",
"migration0/results/informed_normal_migration0_combined/informed_normal_migration0_combined.mcc.tre",
"migration0/results/geo_unknown_migration0_combined/geo_unknown_migration0_combined.mcc.tre",
"migration0/results/incorrect_uniform_migration0_combined/incorrect_uniform_migration0_combined.mcc.tre",
"migration0/results/incorrect_normal_migration0_combined/incorrect_normal_migration0_combined.mcc.tre",
"migration0.2/results/informed_uniform_geneflow_combined/informed_uniform_geneflow_combined.mcc.tre",
"migration0.2/results/informed_normal_geneflow_combined/informed_normal_geneflow_combined.mcc.tre",
"migration0.2/results/geo_unknown_geneflow_combined/geo_unknown_geneflow_combined.mcc.tre",
"migration0.2/results/incorrect_uniform_geneflow_combined/incorrect_uniform_geneflow_combined.mcc.tre",
"migration0.2/results/incorrect_normal_geneflow_combined/incorrect_normal_geneflow_combined.mcc.tre"
)
# Descriptive plot titles
plot_titles <- c(
"Informed Uniform (no migration)",
"Informed Normal (no migration)",
"Geo Unknown (no migration)",
"Incorrect Uniform (no migration)",
"Incorrect Normal (no migration)",
"Informed Uniform (with gene flow)",
"Informed Normal (with gene flow)",
"Geo Unknown (with gene flow)",
"Incorrect Uniform (with gene flow)",
"Incorrect Normal (with gene flow)"
)
# Empty list to store plots
all_plots <- list()
# Loop through files and make plots
for (i in seq_along(tree_paths)) {
full_path <- file.path(base_path, tree_paths[i])
tree <- readTrees(paths = full_path)
tree_data <- tree[[1]][[1]]
annotations <- tree_data@data
expanded <- annotations %>%
filter(!is.na(age_0.95_HPD)) %>%
rowwise() %>%
mutate(posterior_values = list(seq(age_0.95_HPD[1], age_0.95_HPD[2], length.out = 100))) %>%
unnest(posterior_values)
p <- ggplot(expanded, aes(x = posterior_values, fill = as.factor(node))) +
geom_density(alpha = 0.5, adjust = 1.5) +
labs(title = plot_titles[i], x = NULL, y = NULL) +
theme_minimal() +
theme(legend.position = "none", plot.title = element_text(size = 10, hjust = 0.5)) +
scale_fill_viridis_d() +
scale_x_reverse(limits = c(5, -1), breaks = 0:5)
all_plots[[i]] <- p
}
# Reordered plot list
ordered_plots <- c(
all_plots[1], all_plots[6], all_plots[2], all_plots[7], all_plots[3], # Row 1 (no migration)
all_plots[8], all_plots[4], all_plots[9], all_plots[5], all_plots[10]  # Row 2 (with gene flow)
)
# Arrange all plots in a grid (2 columns x 5 rows)
grid.arrange(grobs = ordered_plots, ncol = 1)
#DIVERGENCE TIME ESTIMATIONS FOR ALL TREES
library(RevGadgets)
# Define base path
base_path <- "/Users/lukesparreo/Desktop/BioGeoDating_Geogenomics"
# Define tree paths
tree_paths <- c(
"migration0/results/informed_uniform_migration0_combined/informed_uniform_migration0_combined.mcc.tre",
"migration0/results/informed_normal_migration0_combined/informed_normal_migration0_combined.mcc.tre",
"migration0/results/geo_unknown_migration0_combined/geo_unknown_migration0_combined.mcc.tre",
"migration0/results/incorrect_uniform_migration0_combined/incorrect_uniform_migration0_combined.mcc.tre",
"migration0/results/incorrect_normal_migration0_combined/incorrect_normal_migration0_combined.mcc.tre",
"migration0.2/results/informed_uniform_geneflow_combined/informed_uniform_geneflow_combined.mcc.tre",
"migration0.2/results/informed_normal_geneflow_combined/informed_normal_geneflow_combined.mcc.tre",
"migration0.2/results/geo_unknown_geneflow_combined/geo_unknown_geneflow_combined.mcc.tre",
"migration0.2/results/incorrect_uniform_geneflow_combined/incorrect_uniform_geneflow_combined.mcc.tre",
"migration0.2/results/incorrect_normal_geneflow_combined/incorrect_normal_geneflow_combined.mcc.tre"
)
# Descriptive plot titles
plot_titles <- c(
"Informed Uniform (no migration)",
"Informed Normal (no migration)",
"Geo Unknown (no migration)",
"Incorrect Uniform (no migration)",
"Incorrect Normal (no migration)",
"Informed Uniform (with gene flow)",
"Informed Normal (with gene flow)",
"Geo Unknown (with gene flow)",
"Incorrect Uniform (with gene flow)",
"Incorrect Normal (with gene flow)"
)
# Empty list to store plots
all_plots <- list()
# Loop through files and make plots
for (i in seq_along(tree_paths)) {
full_path <- file.path(base_path, tree_paths[i])
tree <- readTrees(paths = full_path)
tree_data <- tree[[1]][[1]]
annotations <- tree_data@data
expanded <- annotations %>%
filter(!is.na(age_0.95_HPD)) %>%
rowwise() %>%
mutate(posterior_values = list(seq(age_0.95_HPD[1], age_0.95_HPD[2], length.out = 100))) %>%
unnest(posterior_values)
p <- ggplot(expanded, aes(x = posterior_values, fill = as.factor(node))) +
geom_density(alpha = 0.5, adjust = 1.5) +
labs(title = plot_titles[i], x = NULL, y = NULL) +
theme_minimal() +
theme(legend.position = "none", plot.title = element_text(size = 10, hjust = 0.5)) +
scale_fill_viridis_d() +
scale_x_reverse(limits = c(5, -1), breaks = 0:5)
all_plots[[i]] <- p
}
# Reordered plot list
ordered_plots <- c(
all_plots[1], all_plots[6], all_plots[2], all_plots[7], all_plots[3], # Row 1 (no migration)
all_plots[8], all_plots[4], all_plots[9], all_plots[5], all_plots[10]  # Row 2 (with gene flow)
)
# Arrange all plots in a grid (2 columns x 5 rows)
grid.arrange(grobs = ordered_plots, ncol = 1)
# Arrange all plots in a grid (2 columns x 5 rows)
grid.arrange(grobs = ordered_plots, ncol = 1)
# Define base path
base_path <- "/Users/lukesparreo/Desktop/BioGeoDating_Geogenomics"
# Define tree paths
tree_paths <- c(
"migration0/results/informed_uniform_migration0_combined/informed_uniform_migration0_combined.mcc.tre",
"migration0/results/informed_normal_migration0_combined/informed_normal_migration0_combined.mcc.tre",
"migration0/results/geo_unknown_migration0_combined/geo_unknown_migration0_combined.mcc.tre",
"migration0/results/incorrect_uniform_migration0_combined/incorrect_uniform_migration0_combined.mcc.tre",
"migration0/results/incorrect_normal_migration0_combined/incorrect_normal_migration0_combined.mcc.tre",
"migration0.2/results/informed_uniform_geneflow_combined/informed_uniform_geneflow_combined.mcc.tre",
"migration0.2/results/informed_normal_geneflow_combined/informed_normal_geneflow_combined.mcc.tre",
"migration0.2/results/geo_unknown_geneflow_combined/geo_unknown_geneflow_combined.mcc.tre",
"migration0.2/results/incorrect_uniform_geneflow_combined/incorrect_uniform_geneflow_combined.mcc.tre",
"migration0.2/results/incorrect_normal_geneflow_combined/incorrect_normal_geneflow_combined.mcc.tre"
)
# Function to generate density plot for divergence times
make_divergence_density_plot <- function(tree_file, label) {
# Read the MCC tree and extract the tree data
tree <- readTrees(paths = tree_paths)[[1]]
# Extract node ages (divergence times)
node_ages <- tree@data$age
# Remove any NA values if present
node_ages <- node_ages[!is.na(node_ages)]
# Generate the density plot for node ages (divergence times)
ggplot(data = data.frame(age = node_ages), aes(x = age)) +
geom_density(fill = "blue", alpha = 0.5) +
labs(title = label, x = "Divergence Time (Years)", y = "Density") +
theme_minimal() +
theme(legend.position = "none",
plot.title = element_text(size = 10, hjust = 0.5))
}
# Create the plots for each tree
plots <- lapply(tree_paths, function(file) {
# Extract the label from the file path (for use in plot title)
label <- basename(file) # Using the file name as the label
make_divergence_density_plot(file, label)
})
# Arrange the plots into a grid
grid.arrange(grobs = plots, ncol = 2)
