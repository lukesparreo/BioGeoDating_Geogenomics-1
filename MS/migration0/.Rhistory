ggsave(file=plot_fn, plot=pp, device="pdf", height=7, width=10, useDingbats=F)
pp = pp + labs(x="Age (Ma)")
# save
ggsave(file=plot_fn, plot=pp, device="pdf", height=7, width=10, useDingbats=F)
source("/Applications/RevBayes_OSX_v1.0.13/scripts/plot_anc_range.util.R")
source("~/Bedoya Dropbox/Ana Bedoya/Scripts/historic_scripts/plot_anc_range.util.R")
setwd("~/Bedoya Dropbox/Bedoya_Research_Group/BioGeoDating_Geogenomics/MS/migration0/")
# file names
fp = "~/Bedoya Dropbox/Bedoya_Research_Group/BioGeoDating_Geogenomics/MS/migration0/" # edit to provide an absolute filepath
plot_fn = paste(fp, "output_informed_uniform1.range_Pie.pdf",sep="")
tree_fn = paste(fp, "output_informed_uniform1.ase.tre", sep="")
label_fn = paste(fp, "output_informed_uniform1.state_labels.txt", sep="")
color_fn = paste(fp, "pali_range_colors.txt", sep="")
# get state labels and state colors
states = make_states(label_fn, color_fn, fp=fp)
state_labels = states$state_labels
state_colors = states$state_colors
# process the ancestral states
ase <- processAncStates(tree_fn,
# Specify state labels.
# These numbers correspond to
# your input data file.
state_labels = state_labels)
source("~/Bedoya Dropbox/Ana Bedoya/Scripts/historic_scripts/plot_anc_range.util.R")
setwd("~/Bedoya Dropbox/Bedoya_Research_Group/BioGeoDating_Geogenomics/MS/migration0/")
# file names
fp = "~/Bedoya Dropbox/Bedoya_Research_Group/BioGeoDating_Geogenomics/MS/migration0/" # edit to provide an absolute filepath
plot_fn = paste(fp, "output_informed_uniform1.range_Pie.pdf",sep="")
tree_fn = paste(fp, "output_informed_uniform1.ase.tre", sep="")
label_fn = paste(fp, "output_informed_uniform1.state_labels.txt", sep="")
color_fn = paste(fp, "pali_range_colors.txt", sep="")
# get state labels and state colors
states = make_states(label_fn, color_fn, fp=fp)
state_labels = states$state_labels
state_colors = states$state_colors
# process the ancestral states
ase <- processAncStates(tree_fn,
# Specify state labels.
# These numbers correspond to
# your input data file.
state_labels = state_labels)
install.packages("RevGadgets")
install.packages("RevGadgets")
# get state labels and state colors
states = make_states(label_fn, color_fn, fp=fp)
state_labels = states$state_labels
state_colors = states$state_colors
# process the ancestral states
ase <- processAncStates(tree_fn,
# Specify state labels.
# These numbers correspond to
# your input data file.
state_labels = state_labels)
library(RevGadgets)
# get state labels and state colors
states = make_states(label_fn, color_fn, fp=fp)
state_labels = states$state_labels
state_colors = states$state_colors
# process the ancestral states
ase <- processAncStates(tree_fn,
# Specify state labels.
# These numbers correspond to
# your input data file.
state_labels = state_labels)
install.packages("treeio")
library(treeio)
install.packages("treeio")
if (!require("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("treeio")
# get state labels and state colors
states = make_states(label_fn, color_fn, fp=fp)
state_labels = states$state_labels
state_colors = states$state_colors
# process the ancestral states
ase <- processAncStates(tree_fn,
# Specify state labels.
# These numbers correspond to
# your input data file.
state_labels = state_labels)
##plotting
# C (Central America), L (Clow inter Andean), A (High Andes), E (Eastern Amazon), O (Orinoco), F(Atlantic Forest)
colors_main <- c("#4E598C", "#FB9B2D", "#4ECDC4", "#568259","#FF6B6B","#97CC04")
colors_combined <- colorRampPalette(c("#FDA8EF","cyan", "red","royalblue",
"aquamarine", "#73C1FC", "darkviolet"))(128-7)
colors <- c(colors_main, colors_combined)
names(colors) <- state_labels
#change to MAP or pies)
pp_map=plotAncStatesPie(t = ase, node_color = colors, node_pie_size=0.6, tip_labels_size = 2.7,
tip_labels_italics = T, tip_labels_states = T,
node_labels_as = NULL, node_labels_centered = T,
node_labels_offset = 0, tip_labels_states_offset = 1,
tip_labels_states_size = 2, tip_states=F,
cladogenetic = TRUE, tip_labels_offset = 2, timeline = T, geo_units="epochs")+
ggplot2::theme(legend.position = c(0.08, 0.67),
legend.key = element_blank(), legend.title = element_blank(),
legend.text = element_text(size = 11),
legend.background = element_rect(fill="transparent"))+
# andean uplift peaks
ggplot2::geom_vline(xintercept = -23, linetype = "dotted") +
ggplot2::annotate(geom = "text",
x = -23, y = 97,
label = "A1",
hjust = 1,
size = 8)+
ggplot2::geom_vline(xintercept = -12, linetype = "dotted") +
ggplot2::annotate(geom = "text",
x = -12, y = 97,
label = "A2",
hjust = 1,
size = 8)+
ggplot2::geom_vline(xintercept = -4.5, linetype = "dotted") +
ggplot2::annotate(geom = "text",
x = -4.5, y = 97,
label = "A1",
hjust = 1,
size = 8)
install.packages("ggtree")
if (!require("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("ggtree")
#change to MAP or pies)
pp_map=plotAncStatesPie(t = ase, node_color = colors, node_pie_size=0.6, tip_labels_size = 2.7,
tip_labels_italics = T, tip_labels_states = T,
node_labels_as = NULL, node_labels_centered = T,
node_labels_offset = 0, tip_labels_states_offset = 1,
tip_labels_states_size = 2, tip_states=F,
cladogenetic = TRUE, tip_labels_offset = 2, timeline = T, geo_units="epochs")+
ggplot2::theme(legend.position = c(0.08, 0.67),
legend.key = element_blank(), legend.title = element_blank(),
legend.text = element_text(size = 11),
legend.background = element_rect(fill="transparent"))+
# andean uplift peaks
ggplot2::geom_vline(xintercept = -23, linetype = "dotted") +
ggplot2::annotate(geom = "text",
x = -23, y = 97,
label = "A1",
hjust = 1,
size = 8)+
ggplot2::geom_vline(xintercept = -12, linetype = "dotted") +
ggplot2::annotate(geom = "text",
x = -12, y = 97,
label = "A2",
hjust = 1,
size = 8)+
ggplot2::geom_vline(xintercept = -4.5, linetype = "dotted") +
ggplot2::annotate(geom = "text",
x = -4.5, y = 97,
label = "A1",
hjust = 1,
size = 8)
#save
ggsave(file=plot_fn, plot=pp_map, device="pdf", height=15, width=12, useDingbats=F)
#change to MAP or pies)
pp_map=plotAncStatesPie(t = ase, node_color = colors, node_pie_size=0.6, tip_labels_size = 2.7,
tip_labels_italics = T, tip_labels_states = T,
node_labels_as = NULL, node_labels_centered = T,
node_labels_offset = 0, tip_labels_states_offset = 1,
tip_labels_states_size = 2, tip_states=F,
cladogenetic = TRUE, tip_labels_offset = 2, timeline = T, geo_units="epochs")+
ggplot2::theme(legend.position = c(0.08, 0.67),
legend.key = element_blank(), legend.title = element_blank(),
legend.text = element_text(size = 11),
legend.background = element_rect(fill="transparent"))+
# andean uplift peaks
ggplot2::geom_vline(xintercept = -23, linetype = "dotted") +
ggplot2::annotate(geom = "text",
x = -23, y = 97,
label = "A1",
hjust = 1,
size = 8)+
ggplot2::geom_vline(xintercept = -12, linetype = "dotted") +
ggplot2::annotate(geom = "text",
x = -12, y = 97,
label = "A2",
hjust = 1,
size = 8)+
ggplot2::geom_vline(xintercept = -4.5, linetype = "dotted") +
ggplot2::annotate(geom = "text",
x = -4.5, y = 97,
label = "A1",
hjust = 1,
size = 8)
#change to MAP or pies)
pp_map=plotAncStatesPie(t = ase, node_color = colors, node_pie_size=0.6, tip_labels_size = 2.7,
tip_labels_italics = T, tip_labels_states = T,
node_labels_as = NULL, node_labels_centered = T,
node_labels_offset = 0, tip_labels_states_offset = 1,
tip_labels_states_size = 2, tip_states=F,
cladogenetic = TRUE, tip_labels_offset = 2, timeline = T, geo_units="epochs")+
ggplot2::theme(legend.position = c(0.08, 0.67),
legend.key = element_blank(), legend.title = element_blank(),
legend.text = element_text(size = 11),
legend.background = element_rect(fill="transparent"))+
# andean uplift peaks
ggplot2::geom_vline(xintercept = -23, linetype = "dotted") +
ggplot2::annotate(geom = "text",
x = -23, y = 97,
label = "A1",
hjust = 1,
size = 8)+
ggplot2::geom_vline(xintercept = -12, linetype = "dotted") +
ggplot2::annotate(geom = "text",
x = -12, y = 97,
label = "A2",
hjust = 1,
size = 8)+
ggplot2::geom_vline(xintercept = -4.5, linetype = "dotted") +
ggplot2::annotate(geom = "text",
x = -4.5, y = 97,
label = "A1",
hjust = 1,
size = 8)
#save
ggsave(file=plot_fn, plot=pp_map, device="pdf", height=15, width=12, useDingbats=F)
source("~/Bedoya Dropbox/Ana Bedoya/Scripts/historic_scripts/plot_anc_range.util.R")
setwd("~/Bedoya Dropbox/Bedoya_Research_Group/BioGeoDating_Geogenomics/MS/migration0/")
# file names
fp = "~/Bedoya Dropbox/Bedoya_Research_Group/BioGeoDating_Geogenomics/MS/migration0/" # edit to provide an absolute filepath
plot_fn = paste(fp, "output_informed_uniform1.range_Pie.pdf",sep="")
tree_fn = paste(fp, "output_informed_uniform1.ase.tre", sep="")
label_fn = paste(fp, "output_informed_uniform1.state_labels.txt", sep="")
color_fn = paste(fp, "pali_range_colors.txt", sep="")
# get state labels and state colors
states = make_states(label_fn, color_fn, fp=fp)
state_labels = states$state_labels
state_colors = states$state_colors
# process the ancestral states
ase <- processAncStates(tree_fn,
# Specify state labels.
# These numbers correspond to
# your input data file.
state_labels = state_labels)
# get state labels and state colors
states = make_states(label_fn, color_fn, fp=fp)
state_labels = states$state_labels
state_colors = states$state_colors
# process the ancestral states
ase <- processAncStates(tree_fn,
# Specify state labels.
# These numbers correspond to
# your input data file.
state_labels = state_labels)
# get state labels and state colors
states = make_states(label_fn, color_fn, fp=fp)
state_labels = states$state_labels
state_colors = states$state_colors
# process the ancestral states
ase <- processAncStates(tree_fn,
# Specify state labels.
# These numbers correspond to
# your input data file.
state_labels = state_labels)
# get state labels and state colors
states = make_states(label_fn, color_fn, fp=fp)
state_labels = states$state_labels
state_colors = states$state_colors
# process the ancestral states
ase <- processAncStates(tree_fn,
# Specify state labels.
# These numbers correspond to
# your input data file.
state_labels = state_labels)
# get state labels and state colors
states = make_states(label_fn, color_fn, fp=fp)
states
# get state labels and state colors
states = make_states(label_fn, color_fn, fp=fp)
state_labels = states$state_labels
state_colors = states$state_colors
# process the ancestral states
ase <- processAncStates(tree_fn,
# Specify state labels.
# These numbers correspond to
# your input data file.
state_labels = state_labels)
# file names
fp = "~/Bedoya Dropbox/Bedoya_Research_Group/BioGeoDating_Geogenomics/MS/migration0/" # edit to provide an absolute filepath
plot_fn = paste(fp, "output_informed_uniform1.range_Pie.pdf",sep="")
tree_fn = paste(fp, "output_informed_uniform1.ase.tre", sep="")
label_fn = paste(fp, "output_informed_uniform1.state_labels.txt", sep="")
color_fn = paste(fp, "pali_range_colors.txt", sep="")
label_fn
color_fn
# get state labels and state colors
states = make_states(label_fn, color_fn, fp=fp)
states
# get state labels and state colors
states = make_states(label_fn, color_fn, fp=fp)
state_labels = states$state_labels
state_colors = states$state_colors
# process the ancestral states
ase <- processAncStates(tree_fn,
# Specify state labels.
# These numbers correspond to
# your input data file.
state_labels = state_labels)
state_colors
# process the ancestral states
ase <- processAncStates(tree_fn,
# Specify state labels.
# These numbers correspond to
# your input data file.
state_labels = state_labels)
# get state labels and state colors
states = make_states(label_fn, color_fn, fp=fp)
state_labels = states$state_labels
state_colors = states$state_colors
# process the ancestral states
ase <- processAncStates(tree_fn,
# Specify state labels.
# These numbers correspond to
# your input data file.
state_labels = state_labels)
plot_fn = paste(fp, "output_informed_normal1.range_Pie.pdf",sep="")
tree_fn = paste(fp, "output_informed_normal1.ase.tre", sep="")
label_fn = paste(fp, "output_informed_normal1.state_labels.txt", sep="")
color_fn = paste(fp, "pali_range_colors.txt", sep="")
# get state labels and state colors
states = make_states(label_fn, color_fn, fp=fp)
state_labels = states$state_labels
state_colors = states$state_colors
# process the ancestral states
ase <- processAncStates(tree_fn,
# Specify state labels.
# These numbers correspond to
# your input data file.
state_labels = state_labels)
##plotting
# C (Central America), L (Clow inter Andean), A (High Andes), E (Eastern Amazon), O (Orinoco), F(Atlantic Forest)
colors_main <- c("#4E598C", "#FB9B2D", "#4ECDC4", "#568259","#FF6B6B","#97CC04")
colors_combined <- colorRampPalette(c("#FDA8EF","cyan", "red","royalblue",
"aquamarine", "#73C1FC", "darkviolet"))(128-7)
colors <- c(colors_main, colors_combined)
names(colors) <- state_labels
#change to MAP or pies)
pp_map=plotAncStatesPie(t = ase, node_color = colors, node_pie_size=0.6, tip_labels_size = 2.7,
tip_labels_italics = T, tip_labels_states = T,
node_labels_as = NULL, node_labels_centered = T,
node_labels_offset = 0, tip_labels_states_offset = 1,
tip_labels_states_size = 2, tip_states=F,
cladogenetic = TRUE, tip_labels_offset = 2, timeline = T, geo_units="epochs")+
ggplot2::theme(legend.position = c(0.08, 0.67),
legend.key = element_blank(), legend.title = element_blank(),
legend.text = element_text(size = 11),
legend.background = element_rect(fill="transparent"))+
# andean uplift peaks
ggplot2::geom_vline(xintercept = -23, linetype = "dotted") +
ggplot2::annotate(geom = "text",
x = -23, y = 97,
label = "A1",
hjust = 1,
size = 8)+
ggplot2::geom_vline(xintercept = -12, linetype = "dotted") +
ggplot2::annotate(geom = "text",
x = -12, y = 97,
label = "A2",
hjust = 1,
size = 8)+
ggplot2::geom_vline(xintercept = -4.5, linetype = "dotted") +
ggplot2::annotate(geom = "text",
x = -4.5, y = 97,
label = "A1",
hjust = 1,
size = 8)
library(ggplot2)
#change to MAP or pies)
pp_map=plotAncStatesPie(t = ase, node_color = colors, node_pie_size=0.6, tip_labels_size = 2.7,
tip_labels_italics = T, tip_labels_states = T,
node_labels_as = NULL, node_labels_centered = T,
node_labels_offset = 0, tip_labels_states_offset = 1,
tip_labels_states_size = 2, tip_states=F,
cladogenetic = TRUE, tip_labels_offset = 2, timeline = T, geo_units="epochs")+
ggplot2::theme(legend.position = c(0.08, 0.67),
legend.key = element_blank(), legend.title = element_blank(),
legend.text = element_text(size = 11),
legend.background = element_rect(fill="transparent"))+
# andean uplift peaks
ggplot2::geom_vline(xintercept = -23, linetype = "dotted") +
ggplot2::annotate(geom = "text",
x = -23, y = 97,
label = "A1",
hjust = 1,
size = 8)+
ggplot2::geom_vline(xintercept = -12, linetype = "dotted") +
ggplot2::annotate(geom = "text",
x = -12, y = 97,
label = "A2",
hjust = 1,
size = 8)+
ggplot2::geom_vline(xintercept = -4.5, linetype = "dotted") +
ggplot2::annotate(geom = "text",
x = -4.5, y = 97,
label = "A1",
hjust = 1,
size = 8)
.rs.restartR()
source("~/Bedoya Dropbox/Ana Bedoya/Scripts/historic_scripts/plot_anc_range.util.R")
setwd("~/Bedoya Dropbox/Bedoya_Research_Group/BioGeoDating_Geogenomics/MS/migration0/")
# file names
fp = "~/Bedoya Dropbox/Bedoya_Research_Group/BioGeoDating_Geogenomics/MS/migration0/" # edit to provide an absolute filepath
plot_fn = paste(fp, "output_informed_normal1.range_Pie.pdf",sep="")
tree_fn = paste(fp, "output_informed_normal1.ase.tre", sep="")
label_fn = paste(fp, "output_informed_normal1.state_labels.txt", sep="")
color_fn = paste(fp, "pali_range_colors.txt", sep="")
# get state labels and state colors
states = make_states(label_fn, color_fn, fp=fp)
state_labels = states$state_labels
state_colors = states$state_colors
# process the ancestral states
ase <- processAncStates(tree_fn,
# Specify state labels.
# These numbers correspond to
# your input data file.
state_labels = state_labels)
##plotting
# C (Central America), L (Clow inter Andean), A (High Andes), E (Eastern Amazon), O (Orinoco), F(Atlantic Forest)
colors_main <- c("#4E598C", "#FB9B2D", "#4ECDC4", "#568259","#FF6B6B","#97CC04")
colors_combined <- colorRampPalette(c("#FDA8EF","cyan", "red","royalblue",
"aquamarine", "#73C1FC", "darkviolet"))(128-7)
colors <- c(colors_main, colors_combined)
names(colors) <- state_labels
#change to MAP or pies)
pp_map=plotAncStatesPie(t = ase, node_color = colors, node_pie_size=0.6, tip_labels_size = 2.7,
tip_labels_italics = T, tip_labels_states = T,
node_labels_as = NULL, node_labels_centered = T,
node_labels_offset = 0, tip_labels_states_offset = 1,
tip_labels_states_size = 2, tip_states=F,
cladogenetic = TRUE, tip_labels_offset = 2, timeline = T, geo_units="epochs")+
ggplot2::theme(legend.position = c(0.08, 0.67),
legend.key = element_blank(), legend.title = element_blank(),
legend.text = element_text(size = 11),
legend.background = element_rect(fill="transparent"))+
# andean uplift peaks
ggplot2::geom_vline(xintercept = -23, linetype = "dotted") +
ggplot2::annotate(geom = "text",
x = -23, y = 97,
label = "A1",
hjust = 1,
size = 8)+
ggplot2::geom_vline(xintercept = -12, linetype = "dotted") +
ggplot2::annotate(geom = "text",
x = -12, y = 97,
label = "A2",
hjust = 1,
size = 8)+
ggplot2::geom_vline(xintercept = -4.5, linetype = "dotted") +
ggplot2::annotate(geom = "text",
x = -4.5, y = 97,
label = "A1",
hjust = 1,
size = 8)
#change to MAP or pies)
pp_map=plotAncStatesPie(t = ase, node_color = colors, node_pie_size=0.6, tip_labels_size = 2.7,
tip_labels_italics = T, tip_labels_states = T,
node_labels_as = NULL, node_labels_centered = T,
node_labels_offset = 0, tip_labels_states_offset = 1,
tip_labels_states_size = 2, tip_states=F,
cladogenetic = TRUE, tip_labels_offset = 2, timeline = T, geo_units="epochs")+
ggplot2::theme(legend.position = c(0.08, 0.67),
legend.key = element_blank(), legend.title = element_blank(),
legend.text = element_text(size = 11),
legend.background = element_rect(fill="transparent"))+
# andean uplift peaks
ggplot2::geom_vline(xintercept = -23, linetype = "dotted") +
ggplot2::annotate(geom = "text",
x = -23, y = 97,
label = "A1",
hjust = 1,
size = 8)+
ggplot2::geom_vline(xintercept = -12, linetype = "dotted") +
ggplot2::annotate(geom = "text",
x = -12, y = 97,
label = "A2",
hjust = 1,
size = 8)+
ggplot2::geom_vline(xintercept = -4.5, linetype = "dotted") +
ggplot2::annotate(geom = "text",
x = -4.5, y = 97,
label = "A1",
hjust = 1,
size = 8)
#change to MAP or pies)
pp_map=plotAncStatesPie(t = ase, node_color = colors, node_pie_size=0.6, tip_labels_size = 2.7,
tip_labels_italics = T, tip_labels_states = T,
node_labels_as = NULL, node_labels_centered = T,
node_labels_offset = 0, tip_labels_states_offset = 1,
tip_labels_states_size = 2, tip_states=F,
cladogenetic = TRUE, tip_labels_offset = 2, timeline = T, geo_units="epochs")+
ggplot2::theme(legend.position = c(0.08, 0.67),
legend.key = element_blank(), legend.title = element_blank(),
legend.text = element_text(size = 11),
legend.background = element_rect(fill="transparent"))+
# andean uplift peaks
ggplot2::geom_vline(xintercept = -23, linetype = "dotted") +
ggplot2::annotate(geom = "text",
x = -23, y = 97,
label = "A1",
hjust = 1,
size = 8)+
ggplot2::geom_vline(xintercept = -12, linetype = "dotted") +
ggplot2::annotate(geom = "text",
x = -12, y = 97,
label = "A2",
hjust = 1,
size = 8)+
ggplot2::geom_vline(xintercept = -4.5, linetype = "dotted") +
ggplot2::annotate(geom = "text",
x = -4.5, y = 97,
label = "A1",
hjust = 1,
size = 8)
